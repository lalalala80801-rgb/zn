<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>智能交易所 · 曼谷 | 汇率看板</title>
  <style>
    :root{
      --bg:#0b0d12;--card:#121521;--muted:#8a91a4;--text:#e9eefb;--accent:#3da5ff;--buy:#00d188;--sell:#ffb84d;--danger:#ff5470;
      --radius:18px;--shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji"; background:var(--bg); color:var(--text);}    
    header{position:sticky; top:0; z-index:40; background:linear-gradient(180deg, rgba(11,13,18,.95), rgba(11,13,18,.70)); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,.06);}
    .wrap{max-width:1100px;margin:auto;padding:12px 16px;}
    .bar{display:flex;align-items:center;gap:12px;}
    .logo{width:38px;height:38px;border-radius:12px;background:linear-gradient(135deg,#4ac0ff,#6a5bff); display:grid;place-items:center; box-shadow: var(--shadow);}
    .logo b{font-size:18px}
    .brand{display:flex;flex-direction:column;line-height:1.05}
    .brand h1{margin:0;font-size:clamp(18px,4vw,24px)}
    .brand small{color:var(--muted)}
    main{padding:10px 16px 24px}
    .grid{max-width:1100px;margin:auto; display:grid; grid-template-columns: 1fr 360px; gap:16px;}
    @media (max-width: 900px){ .grid{grid-template-columns: 1fr;} }
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,.06)}
    .card h3{margin:0;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.06);font-size:clamp(16px,3.2vw,18px)}
    .rates{width:100%; border-collapse: collapse;}
    .rates thead th{position:sticky; top:0; background:rgba(18,21,33,.95);}
    .rates th,.rates td{padding:12px 10px; text-align:left; border-bottom:1px dashed rgba(255,255,255,.06)}
    .flag{font-size:22px;}
    .code{color:var(--muted); font-size:12px}
    .buy{color:var(--buy); font-weight:600; text-align:center}
    .sell{color:var(--sell); font-weight:600; text-align:center}
    .row{display:flex;align-items:center;gap:10px}
    .side{display:flex;flex-direction:column;gap:16px}
    .hidden{display:none !important}
    .btn{appearance:none; border:1px solid rgba(255,255,255,.12); background:#171b28; color:#fff; padding:10px 14px; border-radius:12px; cursor:pointer; font-size:14px}
    .btn.primary{background:linear-gradient(135deg,#4ac0ff,#6a5bff); border:0;}
    .btn.danger{background:linear-gradient(135deg,#ff7b7b,#ff5470); border:0;}
    .in{width:100%; padding:11px 12px; background:#0f1320; color:#fff; border:1px solid rgba(255,255,255,.1); border-radius:12px;}
    .hint{color:var(--muted); font-size:12px}
    @media (max-width:600px){.wrap{padding:10px 12px}.rates th,.rates td{padding:14px 10px}.flag{font-size:24px}.buy,.sell{font-size:clamp(16px,5.4vw,22px)}.code{font-size:11px}.brand small{font-size:12px}}
  </style>
</head>
<body>
  <header>
    <div class="wrap bar">
      <div class="logo" aria-label="logo"><b>汇</b></div>
      <div class="brand">
        <h1>智能交易所 · 曼谷</h1>
        <small>Chinatown Exchange · Bangkok · 营业时间 10:00–23:00</small>
      </div>
    </div>
  </header>
  <main>
    <div class="grid">
      <section class="card" id="public-board" aria-label="汇率看板">
        <h3>今日汇率</h3>
        <div style="overflow:auto">
          <table class="rates" id="rates-table">
            <thead>
              <tr><th>币种</th><th>国家 / 代码</th><th style="text-align:center">买入</th><th style="text-align:center">卖出</th></tr>
            </thead>
            <tbody id="rates-body"></tbody>
          </table>
        </div>
      </section>
      <aside class="side" id="staff-side">
        <section class="card" id="login-card">
          <h3>员工登录</h3>
          <div style="padding:14px 16px; display:grid; gap:10px">
            <label><div class="hint">账号</div><input class="in" id="login-user" placeholder="staff" /></label>
            <label><div class="hint">密码</div><input class="in" id="login-pass" type="password" placeholder="密码" /></label>
            <button class="btn primary" id="btn-login">登录</button>
          </div>
        </section>
        <section class="card hidden" id="panel-card">
          <h3>员工面板</h3>
          <div style="padding:14px 16px; display:grid; gap:12px">
            <div id="editor-list" style="display:grid; gap:8px"></div>
            <div style="display:flex; gap:8px; flex-wrap:wrap">
              <button class="btn primary" id="btn-save">保存</button>
              <button class="btn" id="btn-reset">重置</button>
              <button class="btn danger" id="btn-logout">退出</button>
            </div>
          </div>
        </section>
      </aside>
    </div>
  </main>
<script>
const ADMIN_ENTRY_MATCHERS=[u=>u.searchParams.get('admin')==='1',u=>u.hash==='#admin',u=>/\/staff\/?$/.test(u.pathname)];
const DEFAULT_USER='staff',DEFAULT_PASS='znjys2025!';
const DEFAULT_RATES=[{flag:'🇺🇸',name:'美元',code:'USD',country:'United States',buy:36.25,sell:36.55},{flag:'🇪🇺',name:'欧元',code:'EUR',country:'European Union',buy:38.8,sell:39.25},{flag:'🇬🇧',name:'英镑',code:'GBP',country:'United Kingdom',buy:45.1,sell:45.7},{flag:'🇨🇳',name:'人民币',code:'CNY',country:'China',buy:4.9,sell:5.05},{flag:'🇸🇬',name:'新加坡元',code:'SGD',country:'Singapore',buy:26.3,sell:26.75},{flag:'🇭🇰',name:'港币',code:'HKD',country:'Hong Kong',buy:4.58,sell:4.65},{flag:'🇰🇷',name:'韩元(₩10,000)',code:'KRW',country:'Korea',buy:268,sell:275},{flag:'🇯🇵',name:'日元(¥100)',code:'JPY',country:'Japan',buy:23.6,sell:24.2}];
const LS={getRates(){try{return JSON.parse(localStorage.getItem('znjys_rates')||'null')}catch(e){return null}},setRates(v){localStorage.setItem('znjys_rates',JSON.stringify(v))},getAuth(){try{return JSON.parse(localStorage.getItem('znjys_auth')||'null')}catch(e){return null}},setAuth(v){localStorage.setItem('znjys_auth',JSON.stringify(v))},clearAuth(){localStorage.removeItem('znjys_auth')}};
const staffSide=document.getElementById('staff-side'),loginCard=document.getElementById('login-card'),panelCard=document.getElementById('panel-card'),btnLogin=document.getElementById('btn-login'),btnLogout=document.getElementById('btn-logout'),btnSave=document.getElementById('btn-save'),btnReset=document.getElementById('btn-reset'),editorList=document.getElementById('editor-list'),ratesBody=document.getElementById('rates-body');
function renderTable(data){ratesBody.innerHTML=data.map(r=>`<tr><td class="row"><span class="flag">${r.flag}</span><b>${r.name}</b></td><td><div>${r.country}</div><div class="code">${r.code}</div></td><td class="buy">${r.buy.toFixed(2)}</td><td class="sell">${r.sell.toFixed(2)}</td></tr>`).join('');}
function renderEditor(data){editorList.innerHTML='';data.forEach((r,i)=>{let d=document.createElement('div');d.className='card';d.style.padding='10px';d.innerHTML=`<div class=row><span class=flag>${r.flag}</span><b>${r.name}</b><span class=code>${r.country}·${r.code}</span></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px"><label><div class=hint>买入</div><input class=in value=${r.buy} data-k=buy data-i=${i}></label><label><div class=hint>卖出</div><input class=in value=${r.sell} data-k=sell data-i=${i}></label></div>`;editorList.appendChild(d)});editorList.querySelectorAll('input').forEach(x=>x.oninput=e=>{let i=+e.target.dataset.i,k=e.target.dataset.k;state.rates[i][k]=parseFloat(e.target.value)||e.target.value;renderTable(state.rates)});}
function adminEntryAllowed(){let u=new URL(location.href);return ADMIN_ENTRY_MATCHERS.some(fn=>fn(u));}
function isAuthed(){let a=LS.getAuth();return a&&a.user&&a.expires>Date.now();}
function login(u,p){if(u===DEFAULT_USER&&p===DEFAULT_PASS){LS.setAuth({user:u,expires:Date.now()+7*864e5});return true}return false}
function logout(){LS.clearAuth();location.reload();}
function showLogin(){staffSide.classList.remove('hidden');loginCard.classList.remove('hidden');panelCard.classList.add('hidden');}
function showPanel(){staffSide.classList.remove('hidden');loginCard.classList.add('hidden');panelCard.classList.remove('hidden');}
function hideStaff(){staffSide.classList.add('hidden');}
const state={rates:LS.getRates()||DEFAULT_RATES.slice()};renderTable(state.rates);
if(isAuthed()){showPanel();renderEditor(state.rates);}else if(adminEntryAllowed()){showLogin();}else hideStaff();
btnLogin.onclick=()=>{if(login(document.getElementById('login-user').value,document.getElementById('login-pass').value)){showPanel();renderEditor(state.rates);}else alert('账号或密码错误');};
btnLogout.onclick=logout;
btnSave.onclick=()=>{LS.setRates(state.rates);alert('已保存');};
btnReset.onclick=()=>{if(confirm('重置?')){state.rates=DEFAULT_RATES.slice();renderTable(state.rates);renderEditor(state.rates);LS.setRates(state.rates);}};
</script>
</body>
</html>
